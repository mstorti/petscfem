# -*- mode: shell-script -*-
#
<:require '../eperlini.pl':>// # Initializes ePerl 

# Synchronize the time step with external frequency
<:
$N = 100;
@vars = qw(N);
octave_export_vars(">data.m.tmp",@vars);
:>//

global_options

nsave 100000000
save_file oscplate.sal
nstep 5

#    Iterative parameters
nnwt 3
tol_newton 0
atol 0
rtol 0
dtol 1e3
solver "iisd_petsc"
iisd_subpart 1

initial_state "couette.ini.tmp"
Dt 1
steady
alpha 1.
G_body 1. 0.
# tau_fac 0.
#if 0
print_linear_system_and_stop
inwt_stop 1
#endif
__END_HASH__

# ndim nu ndof
nodes  2  2  3
__INCLUDE__ couette.nod.tmp
_END_NODES__

elemset nsi_tet_les_fm2 4
# elemset bubbly 4
props 
#
#Datos del elemento
#
name malla
geometry cartesian2d
ndim 2
npg 4
#
# Datos fisicos
#
weak_form 0
#if 0
C_mu 0.
rho_l 1.
rho_g 1e-3
visco_l 0.0001
visco_g 0.0001
#else
viscosity 0.0001
#endif
__END_HASH__
__INCLUDE__ couette.con.tmp
__END_ELEMSET__

end_elemsets

fixa
#if 1
# Pressure at some node
1 3 0.

# velocity set to zero at the bottom
1 1 0.
1 2 1.
2 1 0.
2 2 1.
<:=2*$N+1:> 1 0.
<:=2*$N+1:> 2 0.
<:=2*$N+2:> 1 0.
<:=2*$N+2:> 2 0.
#endif
# __INCLUDE__ couette.fixa.tmp
__END_FIXA__

#
# Periodic boundary conditions from y=0.1 to y=0.
#
constraint

__INCLUDE__ couette.peri.tmp
__END_CONSTRAINT__
