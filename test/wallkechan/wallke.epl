<:
require '../eperlini.pl';       # Initializes ePerl 
doc_vals(qw(case));
:>//                            # ends ePerl block

#default definitions
#===========================================================
global_options
ndim 2

save_file "save.state"
nsave 20

#rtol 1e-2
rtol 0
atol 0
maxits 100

save_file_pattern "outvector%d.out"
#nsaverot 1000000

initial_state "wallke.ini.tmp"
#initial_state "save.state"
#print_some_file "wallke.some"
#save_file_some "wallke.some.tmp"
#nsome 1

alpha 1.
nstep 1
nnwt 1
tol_newton 0
preco_type "lu"
Dt 0.1

#print_linear_system_and_stop
#solve_system 0

#<:
$L = 1;                         # Semi distance between plates
$Re_l = 1000;                   # laminar Re
$Umax = 1;                      # Max vel in the channel
$Uav = 1.5*$Umax;               # Aver vel 
$nu = $Uav*2*$L/$Re_l;          # kinematic visc.
$g = $nu*2*$Umax/$L**2;         # body force
$N = 16;                        # Number of elements in x dir
$Ny = 2;                        # Number of elements in y dir
$Ly = $L/$N*$Ny;                # longitudinal length 
$hratio = 5;                    # refinement near the wall
$hratioy = 1;                   # refinement to the exit
octave_export_vars("data.m.tmp",qw(nu g N Ny hratio hratioy L Ly));
:>//

y_wall_plus 50
#turbulence_coef 0.
viscosity <:=$nu:>
G_body 0. <:=$g:>

weak_form 0 # todavia no tenemos el weak form para k-e (???)

__END_HASH__

# ndim nu ndof
nodes   2  2  5
__INCLUDE__ wallke.nod.tmp
__END_NODES__

#===========================================================
elemset nsi_tet_keps 4
#Datos del elemento
geometry cartesian2d
npg 4
__END_HASH__
__INCLUDE__ wallke.con.tmp
__END_ELEMSET__

elemset wallke 2
geometry cartesian1d
npg 2
__END_HASH__
__INCLUDE__ wallke.wallke.tmp
__END_ELEMSET__

elemset wall_law_res 2
lagrange_diagonal_factor 1e-3
__END_HASH__
__INCLUDE__ wallke.nonlr.tmp
__END_ELEMSET__

end_elemsets

#===========================================================
fixa

# pressure fixed at some node
<:print (($Ny+1)*$N+1):> 3  0.

# u velocity imposed to 0 in all the left wall
__INCLUDE__ wallke.u0.tmp

# fix other fields than the to lagrange multipliers
__INCLUDE__ wallke.fixa_lag.tmp
__END_FIXA__

constraint
__INCLUDE__ wallke.peri.tmp
__END_CONSTRAINT__

# Local Variables: $
# mode: shell-script $
# eval: (setq indent-tabs-mode nil) $
# End: $
