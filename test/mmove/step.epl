# -*- mode: shell-script -*-
# case: <:=$ENV{'case'}:>
<:                              # starts ePerl block
require "$ENV{'PETSCFEM_DIR'}/test/eperlini.pl";# Initializes ePerl 
$N=10;
$disp = 0.3;
$slope = 4;
# $shape = 'quad';
$old_mmove = $ENV{'OLD_MMOVE'};
#
octave_export_vars(">data.m.tmp",qw(N disp shape slope));
:>//                            # ends ePerl block

# <: pr('old_mmove') :>
global_options

ndim 2
nsave 5
steady
<:$nstep=1;:>
nstep <:=$nstep+4:>
#if $old_mmove
displ_factor <:=1./$nstep:>
#else
Dt <:=1./$nstep:>
#endif

# file containing the weight (speed) of processors
proc_weights weights.dat

#    Iterative parameters
tol_tet 1e-5
tol_newton 1e-10
atol 0
rtol 1e-6
dtol 1e3
nnwt 1
# newton_relaxation_factor 0.1 2 1.

solver "iisd"
iisd_subpart 40
pc_lu_fill 10.

partitioning_method "metis"
# partitioning_method "nearest_neighbor"
# partitioning_method "hitchhiking"
# partitioning_method "random"
max_partgraph_vertices 20000    
max_partgraph_vertices_proc 5000

save_file "step.state.tmp"
__END_HASH__

# ndim nu ndof
nodes  2 2 2
#__INCLUDE__ auto_33_62.nod
__INCLUDE__ step.nod.tmp
_END_NODES__

# elemset mesh_move<:= ($old_mmove ? '' : '_old') :> 3
elemset mesh_move_eig_anal 3
name malla
# report_consumed_time
geometry triangle
npg 1
c_volume 0.
__END_HASH__
__INCLUDE__ step.con.tmp
__END_ELEMSET__

end_elemsets

#if !$old_mmove
fixa_amplitude piecewise_linear
filename "piecewise.dat.tmp"
__END_HASH__
__INCLUDE__ step.fixa.tmp
__END_FIXA__
#else
fixa
__INCLUDE__ step.fixa.tmp
__END_FIXA__
#endif
