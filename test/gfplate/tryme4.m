Q= [0 0  1.000000
    1 1  1.000000
    2 2  1.000000
    3 3  1.000000
    4 4  1.000000
    5 5  1.000000
    6 5  0.500000
    6 6  0.500000
    7 6  1.000000
    8 6  0.500000
    8 7  0.500000
    9 7  1.000000
    10 8  1.000000
    11 9  1.000000
    12 10  1.000000];
Q(:,1:2) = Q(:,1:2) + 1;
Q = getblock(Q);

[m,n] = size(Q);

if 1
    y = [0 0 0 0 0 0 0.5 0 0.5 0 0 0 0]';
else 
  y = 2*rand(m,1)-1;
  y(7)=0.5*(y(6)+y(8));
  y(9)=0.5*(y(8)+y(10));
endif

QQ = Q'*Q;
D=diag(QQ);

z = Q'*y;
x = 0*z;
omega = 1.0;

for k=1:10
  res = z-QQ*x;
  merr(res)
  x = x + omega*res./D;
  x
endfor
