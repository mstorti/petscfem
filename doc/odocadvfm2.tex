%-----<>-----<>-----<>-----<>-----<>-----<>-----<>-----<>-----<>-----<>
% DON'T EDIT MANUALLY THIS FILE !!!!!!
% This files automatically generated by odoc.pl from 
% source file "../../doc/advdifop.tex"
%-----<>-----<>-----<>-----<>-----<>-----<>-----<>-----<>-----<>-----<>
\index{tau\_fac@\verb+tau_fac+}
\item\verb+double tau_fac+ {\rm(default=\verb|1.|)}:

Scale the SUPG upwind term. 

%----<>----<>----<>----<>----<>----<>----<>----<>----<>----<>
\item\verb+ double[var_len]+ \verb+ advective_jacobians+ {\rm(default=\verb| no default|)}:
 
Jacobian of advective fluxes. That means 

\begin{equation} 
   A_{j\mu\nu} = \dep {\F^\conv_{i\mu}}{U_\nu}
\end{equation}

The full jacobian has \verb+ndim*ndof*ndof+ components, but in many
cases the Jacobian is not full. The following cases are considered. 
%
\begin{itemize}

\item{\tt null}: (\verb+var_len=0+) This means $A\equiv 0$. No
advection term is present.

%<*>---<*>---<*>---<*>---<*>---<*>---<*>---<*>---<*>---<*>---<*> 
\item{\tt global\_vector} (\verb+var_len=ndim+) This means a vector
that is constant for all fields: $A_{j\mu\nu} = u_j \,
\delta_{\mu\nu}$. 

%<*>---<*>---<*>---<*>---<*>---<*>---<*>---<*>---<*>---<*>---<*> 
\item{\tt vector\_per\_field} (\verb+var_len=ndof*ndim+) This means a vector
for each field: 
%
\begin{equation}
  A_{j\mu\nu} = {\bar u}_{j\mu} \, \delta_{\mu\nu} \text{(No sum over $\mu$)}
\end{equation}
%
The values of $\bar u$ are entered in order 
\(\{\{{\bar u}_{j\mu}\},j=1,\ndim\},\mu=1,\ndof\}\). 

%<*>---<*>---<*>---<*>---<*>---<*>---<*>---<*>---<*>---<*>---<*> 
\item{\tt full} (\verb+var_len=ndof*ndof*ndim+) 
The values of the full advective jacobians are entered in the order 
\(\{\{\{A_{j\mu\nu}\},\nu=1,\ndof\},\mu=1,\ndof\},j=1,\ndim\}\). 
\end{itemize}

%<*>---<*>---<*>---<*>---<*>---<*>---<*>---<*>---<*>---<*>---<*> 

Which of the several possibilities is chosen depends on the size of
the vector entered and on the string value of the option
\verb+advective_jacobians_type+, according to the following rules:

\begin{enumerate}
\item If the option \verb+advective_jacobians_type+ is explicitly
entered, then the size of the entered data vector must agree with the
value of \verb+var_len+ given above. If this is not so, an error is
issued. 

\item Otherwise, the corresponding jacobian type is determined from
the length of the vector entered according to the first type that
matches \verb+var_len+. If no type matches an error is issued. 

\item If both lines \verb+advective_jacobians_type+ and
\verb+advective_jacobians+ are missing, then a \verb+null+ jacobian is
assumed. 
\end{enumerate}

Some examples follow:

\begin{itemize}
\item For instance if $\ndim=2$ and $\ndof=3$ then the following lines
%
\begin{verbatim}
advective_jacobians_type "full"
advective_jacobians \
    3.281371 0.547628 1.146676  \
    0.547628 0.075290 -0.599221  \
    1.146676 -0.599221 1.436927  \
    -0.685102 -0.089878 -1.024710  \
    -0.089878 0.086971 0.468728  \
    -1.024710 0.468728 0.109558  
\end{verbatim}
%
means a full jacobian so that \(!A_x = A_{1\,.\,\,.\ }\) and \(!A_y =
A_{2\,.\,\,.\ }\) are
%
\begin{equation} 
\begin{split}
!A_x &= \begin{sqmat}{ccc}
    3.281371 & 0.547628 &1.146676  \\
    0.547628 &0.075290 &-0.599221  \\
    1.146676 &-0.599221 &1.436927 
       \end{sqmat} \\
!A_y &= \begin{sqmat}{ccc}
    -0.685102 &-0.089878 &-1.024710  \\
    -0.089878 &0.086971 &0.468728  \\
    -1.024710 &0.468728 &0.109558  
       \end{sqmat} \\
\end{split}
\end{equation}

\item If the folowing line are entered, instead:
%
\begin{verbatim}
advective_jacobians_type "full"
advective_jacobians \
    3.281371 0.547628 1.146676  \
    0.547628 0.075290 -0.599221 
\end{verbatim}
%
an error condition is issued, since even if the number of values
entered (\verb+var_len=6+) matches for the ``\verb+vector_per_field+'' 
jacobian type, this doesn't agree with the type requested in the
``\verb+advective_jacobians_type+'' entry. 

\item However, if the ``\verb+advective_jacobians_type+'' line is
removed, then a ``\verb+vector_per_field+'' type is assumed, and no
error condition is generated. 

\end{itemize}

% If of length \verb+double[ndim]+ then it
% is a velocity vector equal for all fields (stored in the order $u_i,
% i=1,\dots,\ndim$).  If of length \verb+double[ndim*ndof]+ then it is a
% velocity vector per field (stored in the order
% $u^1_1,\ldots,u^1_\ndim,\ldots,u^\ndof_1,\ldots,u^\ndof_\ndim$). If of
% length \verb+double[ndim*ndof*ndof]+ then it is a
% \verb+ndof*ndof*ndof+ matrix per dimension (stored in order
% $!A^1,\ldots,!A^\ndim$, where each jacobian is stored by rows.)
 %----<>----<>----<>----<>----<>----<>----<>----<>----<>----<>
\index{advective\_jacobians\_type@\verb+advective_jacobians_type+}
\item\verb+string advective_jacobians_type+ {\rm(default=\verb|string("undefined")|)}:

Set advective jacobian to the desired type. May be one of 
``\verb+null+'', ``\verb+global_vector+'', ``\verb+vector_per_field+'' or ``\verb+full+''. 
See documentation for the \verb+advective_jacobians+ option. 

%----<>----<>----<>----<>----<>----<>----<>----<>----<>----<>
\item\verb+ double[var_len]+ \verb+ diffusive_jacobians+ {\rm(default=\verb| no default|)}:
 
Jacobian of diffusive fluxes, i.e. 
\(\F^{\diff\mu}_i = \D_{ij\mu\nu}\, \prt_j U^\nu\). 
\verb+var_len+ may be one of:
%
The full jacobian has \verb+ndim*ndim*ndof*ndof+ components, but in many
cases the Jacobian is not full. The following cases are
considered. (See the description for the \verb+advetive_jacobians+
entry). 
%
\begin{itemize}
%
\item{\tt null}: (\verb+var_len=0+) This means $D\equiv 0$. No
diffusion term is present. Beware that this can lead (but not
necessarily) to singularities. 

\item {\tt global\_scalar} {\tt [var\_len==1]} (A scalar) 
Isotropic diffusivity, the same
for all fields (\(\D_{ij}^{\mu\nu} = \bar{\D} \, \delta^{\mu\nu} \,
\delta_{ij}\)).
%
\item{\tt global\_tensor} {\tt [var\_len==ndim*ndim]}] Diffusivity tensor
equal for all fields (\(\D_{ij}^{\mu\nu} = \bD_{ij} \,
\delta^{\mu\nu}\)) stored by rows (\(\{\{\bD_{ij},j=1,\ndim\},i=1,\ndim\}\)).
%
\item{\tt scalar\_per\_field} [{\tt [var\_len==ndof]}] 
A scalar diffusivity per field (\(\D_{ij}^{\mu\nu} = {\bD_\mu} \,
\delta^{\mu\nu} \, \delta^{ij}\), no sum over \(\mu\)). 
%
\item{\tt tensor\_per\_field} [{\tt [var\_len==ndim*ndim*ndof]}] 
Diffusivity tensor per field (\(\D_{ij}^{\mu\nu} = {\bD_{ij}^\mu} \,
\delta^{\mu\nu}\)) stored \(\{\{\{\bD_{ij}^\mu,j=1,\ndim\},i=1,\ndim\},\mu=1,\ndof\}\).
%
\item{\tt full} {\tt [var\_len==ndim*ndim*ndof*ndof]}] General case,
stored in order
\(\{\{\{\{\D_{ij}^{\mu\nu},j=1,\ndim\},i=1,\ndim\},\nu=1,\ndof\},\mu=1,\ndof\}\).
\end{itemize}
 %----<>----<>----<>----<>----<>----<>----<>----<>----<>----<>
\index{diffusive\_jacobians\_type@\verb+diffusive_jacobians_type+}
\item\verb+string diffusive_jacobians_type+ {\rm(default=\verb|string("undefined")|)}:

Set diffusive jacobian to the desired type

%----<>----<>----<>----<>----<>----<>----<>----<>----<>----<>
\item\verb+ double[var_len]+ \verb+ reactive_jacobians+ {\rm(default=\verb| all zero|)}:
 
 FIXME:= TO BE DOCUMENTED LATER
 %----<>----<>----<>----<>----<>----<>----<>----<>----<>----<>
\index{reactive\_jacobians\_type@\verb+reactive_jacobians_type+}
\item\verb+string reactive_jacobians_type+ {\rm(default=\verb|string("undefined")|)}:

Set reactive jacobian to the desired type

%----<>----<>----<>----<>----<>----<>----<>----<>----<>----<>
\item\verb+ double[var_len]+ \verb+ source term+ {\rm(default=\verb| all zero|)}:
 
 FIXME:= TO BE DOCUMENTED LATER
 %----<>----<>----<>----<>----<>----<>----<>----<>----<>----<>
\index{source\_term\_type@\verb+source_term_type+}
\item\verb+string source_term_type+ {\rm(default=\verb|string("undefined")|)}:

Set source term to the desired type

%----<>----<>----<>----<>----<>----<>----<>----<>----<>----<>
%-----<>-----<>-----<>-----<>-----<>-----<>-----<>-----<>-----<>-----<>
% DON'T EDIT MANUALLY THIS FILE !!!!!!
% This files automatically generated by odoc.pl from 
% source file "../../doc/advdifop.tex"
%-----<>-----<>-----<>-----<>-----<>-----<>-----<>-----<>-----<>-----<>
